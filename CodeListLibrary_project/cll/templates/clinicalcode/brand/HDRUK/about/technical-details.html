{% extends "base.html" %}
{% load static %}
{% block title %}{% endblock title %}
{% block description %} HDR-UK Technical Details {% endblock description %}
{% block keywords %}, hdr-uk, Phenotype, BREATHE, phenotyping algorithms, analysis, Terminology, files {% endblock keywords %}
{% block head %}
<link href="{% static 'css/brands/HDRUK/aboutPageStyle.css' %}" rel="stylesheet" />
{% endblock head %}
{% block scrollNav %}
data-spy="scroll" data-target="#TechnicalMenu" data-offset = "220"
{% endblock scrollNav %}
{% block container %}



<div class="row">
   <nav class="col-sm-2 hideleft-navbar " id="TechnicalMenu"  style="padding-top: 20px; position: sticky; height: min-content; position: -webkit-sticky; top: 60px;">

         <ul class="nav left-navbar " id='navList'>
            <li><a href="#technicaldoc" id="technicalHeader">Technical Documentation
               </a>
            </li>
            <li><a href="#inclusion">Inclusion Criteria
               </a>
            </li>
            <li><a href="#spec">Specification
               </a>
            </li>
            <li><a href="#naming">File Naming
               </a>
            </li>
            <li><a href="#def">Definition File
               </a>
            </li>
            <li><a href="#term">Terminology Files
               </a>
            </li>
            <li><a href="#howto">How to Submit Data
               </a>
            </li>
         </ul>

   </nav>
    <h3><span id="technicaldoc"></span></h3>
   <div style="width:70%;" class="column" >
      <div class="header-content-design" style="padding-bottom:30px;">
         Technical Documentation
      </div>
      <div class="medium-header-design" id="inclusion">
         Phenotype Library Inclusion Criteria
      </div>
      <ul>
         <li>Define a disease (e.g. hypertension), life style risk factor (e.g. smoking) or biomarker (e.g. blood pressure)</li>
         <li>Derive information from one or more electronic health record data sources. This can include national and local sources. The definition of EHR includes administrative data such as billing/claims data, and clinical audits.</li>
         <li>Have one or more peer-reviewed outputs associated with it e.g. journal publication, scientific conferences, policy white papers etc.</li>
         <li>Provide evidence of how the phenotyping algorithm was validated.</li>
      </ul>
      <div class="medium-header-design" id="spec">
         Specification
      </div>
      <p>Phenotyping algorithms are stored in the Phenotype Library usign a combination of YAML, CSV and markdown files. There are two main components to each algorothm: a) the phenotype definition file (which is in YAML and markdown) and, b) one or more teminology files (also known as codelists) which are stored as CSV files. The section below provides information on their schema and contents.</p>
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="481px" viewBox="-0.5 -0.5 481 241" content="<mxfile host=&quot;Electron&quot; modified=&quot;2020-07-17T10:25:32.250Z&quot; agent=&quot;5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/13.2.4 Chrome/83.0.4103.104 Electron/9.0.4 Safari/537.36&quot; etag=&quot;rJQazkSRR-_YdsYiEPns&quot; version=&quot;13.2.4&quot; type=&quot;device&quot;><diagram id=&quot;prtHgNgQTEPvFCAcTncT&quot; name=&quot;Page-1&quot;>7Vjvb9o6FP1r+LiJJBDox0LbVVqZqjFtn01ySfzm2MwxDeyv373ESXCSUrQNqe+9SkjEx9e/7jm+HDII5tnug2abdKFiEAN/GO8Gwc3A9z1vGOIXIXuLDIdBiSSaxxZrgCX/CVWgRbc8htwJNEoJwzcuGCkpITIOxrRWhRu2VsJddcMS6ADLiIku+o3HJi3RqT9p8HvgSVqt7IVXZU/GqmB7kjxlsSqOoOB2EMy1UqZ8ynZzEJS9Ki/luLtneuuNaZDmnAHxp93+08dJNJmuHoqnPIbF/fidZ6d5YmJrT3wrMI9aSR4hfg9M4Dn84WeIlI5zfHpMQSqz33CZUI5FojQ3aWYPafZV5vKCZ4JJbM1SkwkEPXzMDdPG0owbxj4c/lNJw6qIiBpcgv6y31CU0UBzJILlxCWN6R69OgZoA7sjyKbiA6gMjN5jiO0dWVasLqe2WTQcjyosPeK3HsesrpJ65ib1+GCz389EolarO7j/lq9md/+wXTj7WqzfeaMOE1WmgS4QrLnkhis5IJ7xWgUepWLNMd8nUr/GbC5tzyG7KRfxA9urLZ0I2Yi+V60uFcdkjexqYq6E0ghIVXJbD1rSZJYhDTkOe6wY8lrQgu2cwAeWGwtESgi2yfmq3nLGdMLlTBmjMkcAHbZdTZwQ/LOy8KauLoKuLrxxjy6uTsjCLoY3yDCZEF31auH4xdVGPau1RYh3FLRkBmZqK+mStrRYn/MP5DnuyHMBhsXMsI78kBRzUI9W36Ellx4FMcETiU0BaxpGrHIswNcWNmpDk21YhBXn4RBzM2qQzzYtBCkcuxaHIpvyOAZJAlMG91iqiaSzUVyaQ97GM/xgJufD9+PBGDc+x7bXtPFD4drMlcSzYE2idQClWgDJ9TwVnrjsXRXuXX5fUh0BlylGYYdtTIKhQ72R/ZfJDv0zyZ5eiOzKoByR3WEZYnRFtglipYrbBpgdAOyoyKx+Oa7JfzXUg4xbiKZyBbFT1Gkl1+5h+YdT+a0S89u1X4Nghj+5y56o5I+kqqaK++ORU8U9v1Wec7XVEdhRf780+10PhwZBkGhX+JDQw5ycOc9p16VjKPtxvTqkw3mRcgNLvHjULtDfu06uuskRJh10z13O8FYe9EEO7g6NNznGciwhC/XUABKOFXUzmOB2wh9b8sazRns1NAiuj/pdPTZBeMfrxpEg+2c5SLJ/bC3cs0ZObi5pUK5cx+CFPT8Vw57qEV7Kt/pdY/Cmvv+q+gLv1clv+ia//438/OGrk1/XKL8m73RmwnG7B4tyxj+Cl93Y+FWZrO5ErX/4Xlsb5Qkv59b8f41izjbgF/LVVy7l/vA3KQ/C1kTt9yfPUI75Y/ujMPtv8tkNB74rrdYbWXwoZzxTT9hs3g6X4c1L9uD2Fw==</diagram></mxfile>" onclick="(function(svg){var src=window.event.target||window.event.srcElement;while (src!=null&amp;&amp;src.nodeName.toLowerCase()!='a'){src=src.parentNode;}if(src==null){if(svg.wnd!=null&amp;&amp;!svg.wnd.closed){svg.wnd.focus();}else{var r=function(evt){if(evt.data=='ready'&amp;&amp;evt.source==svg.wnd){svg.wnd.postMessage(decodeURIComponent(svg.getAttribute('content')),'*');window.removeEventListener('message',r);}};window.addEventListener('message',r);svg.wnd=window.open('https://app.diagrams.net/?client=1&amp;lightbox=1&amp;edit=_blank');}}})(this);" style="cursor:pointer;max-width:100%;max-height:241px;">
         <defs>
            <clipPath id="mx-clip-184-75-142-22-0">
               <rect x="184" y="75" width="142" height="22"></rect>
            </clipPath>
            <clipPath id="mx-clip-184-97-142-28-0">
               <rect x="184" y="97" width="142" height="28"></rect>
            </clipPath>
         </defs>
         <g>
            <path d="M 0 20 L 0 0 L 480 0 L 480 20" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"></path>
            <path d="M 0 20 L 0 240 L 480 240 L 480 20" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"></path>
            <path d="M 0 20 L 480 20" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"></path>
            <g transform="translate(-0.5 -0.5)">
               <switch>
                  <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
                     <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 10px; margin-left: 240px;">
                        <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
                           <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; font-weight: bold; white-space: nowrap; ">Electronic Health Records Phenotyping algorithm</div>
                        </div>
                     </div>
                  </foreignObject>
                  <text x="240" y="14" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Electronic Health Records Phenotyping algorithm</text>
               </switch>
            </g>
            <path d="M 180 70 L 180 30 L 330 30 L 330 70" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"></path>
            <path d="M 180 70 L 180 120 L 330 120 L 330 70" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"></path>
            <path d="M 180 70 L 330 70" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"></path>
            <g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px">
               <text x="254.5" y="47.5">Phenotype definition </text>
               <text x="254.5" y="61.5">file</text>
            </g>
            <g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-184-75-142-22-0)" font-size="12px">
               <text x="185.5" y="87.5">Metadata</text>
            </g>
            <g fill="#000000" font-family="Helvetica" clip-path="url(#mx-clip-184-97-142-28-0)" font-size="12px">
               <text x="185.5" y="109.5">Content</text>
            </g>
            <path d="M 254 120 L 254 140 L 255 140 L 255 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"></path>
            <rect x="95" y="160" width="100" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"></rect>
            <g transform="translate(-0.5 -0.5)">
               <switch>
                  <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
                     <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 190px; margin-left: 96px;">
                        <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
                           <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><b>Codelist file</b></div>
                        </div>
                     </div>
                  </foreignObject>
                  <text x="145" y="194" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Codelist file</text>
               </switch>
            </g>
            <rect x="315" y="160" width="100" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"></rect>
            <g transform="translate(-0.5 -0.5)">
               <switch>
                  <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
                     <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 190px; margin-left: 316px;">
                        <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
                           <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><b>Codelist file</b></div>
                        </div>
                     </div>
                  </foreignObject>
                  <text x="365" y="194" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Codelist file</text>
               </switch>
            </g>
            <rect x="205" y="160" width="100" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"></rect>
            <g transform="translate(-0.5 -0.5)">
               <switch>
                  <foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility">
                     <div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 98px; height: 1px; padding-top: 190px; margin-left: 206px;">
                        <div style="box-sizing: border-box; font-size: 0; text-align: center; ">
                           <div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; "><b>Codelist file</b></div>
                        </div>
                     </div>
                  </foreignObject>
                  <text x="255" y="194" fill="#000000" font-family="Helvetica" font-size="12px" text-anchor="middle">Codelist file</text>
               </switch>
            </g>
            <path d="M 255 120 L 255 140 L 365 140 L 365 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"></path>
            <path d="M 254 120 L 254 140 L 145 140 L 145 160" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"></path>
         </g>
         <switch>
            <g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"></g>
            <a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target=_blank >
               <text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text>
            </a>
         </switch>
      </svg>
      <div class="medium-header-design" id="naming">
         File Naming
      </div>
      <p>All phenotype definition files associated with a phenotype use a common naming pattern:</p>
      <div class="language-plaintext highlighter-rouge">
         <div class="highlight">
            <pre class="highlight"><code>AUTHORSURNAME_NAME_UUID.md
</code></pre>
         </div>
      </div>
      <p>for example: <code class="language-plaintext highlighter-rouge">axson_bronchiestasis_ZckoXfUWNXn8Jn7fdLQuxj.md</code></p>
      <p>Phenotype files are stored in the <a href="https://github.com/spiros/hdr-caliber-phenome-portal/tree/master/_phenotypes" target=_blank  rel="noopener noreferrer">_phenotypes directory</a>.</p>
      <p>Similarly, code list files follow a similar pattern:</p>
      <pre class="highlight"><code>NAME_UUID_TERMINOLOGY.csv
</code></pre>
       <p>for example: <code class="language-plaintext highlighter-rouge">axson_bronchiestasis_ZckoXfUWNXn8Jn7fdLQuxj_ICD10.csv</code></p>
       <p>Codelist files are stored in the <a href="https://github.com/spiros/hdr-caliber-phenome-portal/tree/master/_data/codelists">codelists directory</a>.</p>
      <div class="medium-header-design" id="def">
         Phenotype definition file
      </div>
      <p>The phenotype definition file is a markdown file with a YAML header. The YAML header is used to record metadata fields capturing information about the algorithm, the data sources, controlled clinical terminologies and other information.</p>
      <p>For example, the code snippet below displays the metadata associated with the <a href={% url 'phenotype_history_detail' bron_id bron_version %}  target=_blank   rel="noopener noreferrer">bronchiestasis</a> phenotyping algorithm submitted by the HDR UK BREATHE Hub (you can view the <a href="https://raw.githubusercontent.com/spiros/hdr-caliber-phenome-portal/master/_phenotypes/axson_bronchiestasis_ZckoXfUWNXn8Jn7fdLQuxj.md" target=_blank   rel="noopener noreferrer">raw file</a> directly on the repository.)</p>
      <pre class="highlight"><code><span class="na">title</span><span class="pi">:</span> <span class="s">Bronchiestasis</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">Bronchiestasis</span>
<span class="na">phenotype_id</span><span class="pi">:</span> <span class="s">ZckoXfUWNXn8Jn7fdLQuxj</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">Disease or Syndrome</span>
<span class="na">group</span><span class="pi">:</span> <span class="s">Respiratory</span>
<span class="na">data_sources</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">Clinical Practice Research Datalink GOLD</span>
    <span class="pi">-</span> <span class="s">Clinical Practice Research Datalink Aurum</span>
    <span class="pi">-</span> <span class="s">Hospital Episode Statistics APC for CPRD GOLD</span>
    <span class="pi">-</span> <span class="s">Hospital Episode Statistics APC for CPRD Aurum</span>
    <span class="pi">-</span> <span class="s">Death Registration data for CPRD GOLD</span>
    <span class="pi">-</span> <span class="s">Death Registration data for CPRD Aurum</span>
    <span class="pi">-</span> <span class="s">UK Biobank</span>
<span class="na">clinical_terminologies</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">Read Version </span><span class="m">2</span>
    <span class="pi">-</span> <span class="s">SNOMED-CT</span>
    <span class="pi">-</span> <span class="s">ICD-10</span>
    <span class="pi">-</span> <span class="s">ICD-11</span>
<span class="na">validation</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">prognostic</span>
<span class="na">codelists</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">axson_bronchiestasis_ZckoXfUWNXn8Jn7fdLQuxj_ICD10.csv</span>
    <span class="pi">-</span> <span class="s">axson_bronchiestasis_ZckoXfUWNXn8Jn7fdLQuxj_ICD11.csv</span>
    <span class="pi">-</span> <span class="s">axson_bronchiestasis_ZckoXfUWNXn8Jn7fdLQuxj_SNOMEDCT.csv</span>
    <span class="pi">-</span> <span class="s">axson_bronchiestasis_ZckoXfUWNXn8Jn7fdLQuxj_UKBIOBANK.csv</span>
<span class="na">valid_event_data_range</span><span class="pi">:</span> <span class="s">01/01/2001 - 31/12/2019</span>
<span class="na">sex</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">Female</span>
    <span class="pi">-</span> <span class="s">Male</span>
<span class="na">author</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">Eleanor L Axson</span>
    <span class="pi">-</span> <span class="s">Jennifer K Quint</span>
<span class="na">publications</span><span class="pi">:</span>
<span class="na">status</span><span class="pi">:</span> <span class="s">BETA</span>
<span class="na">date</span><span class="pi">:</span> <span class="s">2019-06-20</span>
<span class="na">modified_date</span><span class="pi">:</span> <span class="s">2019-06-20</span>
<span class="na">version</span><span class="pi">:</span> <span class="m">1</span>
</code></pre>
      <p>The metadata fields required are the following:</p>
      <ul>
         <li><strong>title</strong> (string): Phenotype (long) name</li>
         <li><strong>name (string)</strong>: Phenotype (short) name</li>
         <li><strong>data_sources</strong> (list of strings): Names of data sources that phenotype sources information from. These should be identical, if possible, to the names used to identify individual datasets in the <a href="https://www.healthdatagateway.org/" target=_blank   rel="noopener noreferrer">HDR Gateway</a>.</li>
         <li><strong>clinical_terminologies</strong> (list of strings): List of controlled clinical terminologies that are used by the phenotype algorithm.</li>
         <li>
            <strong>validation</strong> (list of strings): evidence of validation used as evidence of phenotype robustness - valid values:
            <ul>
               <li><em>prognostic</em>: the ability to replicate known prognostic associations</li>
               <li><em>aetiologic</em>: the ability to replicate known associations with risk factors</li>
               <li><em>genetic</em> : the abity to replicate associations with known regions or variants</li>
               <li><em>cross-source</em>: has the algorithm been evaluated in a similar external data source</li>
               <li><em>casenote review</em> : has the algorithm been validated through manual review of clinical notes (this usually would result to PPV, NPV values)</li>
               <li><em>cross-country</em> : has the algorithm been evaluated in a similar external healthcare system</li>
            </ul>
         </li>
         <li><strong>codelists</strong> (list of strings): (unordered) list of CSV terminology files associated with the phenotype</li>
         <li><strong>phenotype_id</strong> (list of strings): Unique universal phenotype identifier, generated using the <code class="language-plaintext highlighter-rouge">shortuuid</code> <a href="https://pypi.org/project/shortuuid/" target=_blank   rel="noopener noreferrer">Python module</a>.</li>
         <li><strong>group</strong> (string): Disease group for phenotype</li>
         <li><strong>valid_event_data_range</strong> (list of strings): DD/MM/YYYY date range for events</li>
         <li><strong>sex</strong> (list of strings): list of sexes valid for the phenotype</li>
         <li><strong>author</strong> (list of strings): list of phenotype authors</li>
         <li><strong>publications</strong> (list of strings): list of publications</li>
         <li><strong>status</strong> (string): 'DRAFT' or 'FINAL' status</li>
         <li><strong>date</strong> (string): date created</li>
         <li><strong>modified_date</strong> (string): date last modified</li>
         <li><strong>version</strong> (integer): integer version of phenotype, default '1'/li>
      </ul>
      <div class="medium-header-design" id="term">
         Terminology files (codelists)
      </div>
      <p>Codelist files are specified as CSV files with one term per row - for example:</p>
      <div class="language-plaintext highlighter-rouge">
         <div class="highlight">
            <pre class="highlight"><code>ICD-10 code,ICD-10 term
J47,Bronchiectasis
</code></pre>
         </div>
      </div>
      <div class="medium-header-design" id="howto">
         How to submit data
      </div>
      <p>You can download a <a href="https://raw.githubusercontent.com/spiros/hdr-caliber-phenome-portal/develop/sample_phenotype_1233456.md" target=_blank   rel="noopener noreferrer"><strong>sample template file</strong></a> from the repository:</p>
      <p>If you have a phenotyping algorithm that meets the eligibility requirements, we invite you to submit your data by one of the following ways:</p>
      <ul>
        <li style="list-style-type:circle; margin-left:20px;">by <strong>email</strong> <a href="mailto:s.denaxas[@]ucl.ac.uk">s.denaxas at ucl.ac.uk</a></li>
        <li style="list-style-type:circle; margin-left:20px;">by <strong>pull request (PR)</strong> on the <a href="https://github.com/spiros/hdr-caliber-phenome-portal">GitHub repository</a></li>
        <li style="list-style-type:circle; margin-left:20px;">by <a href="https://forms.gle/J5dm94jeT6MG1StP9"><strong>Google form</strong></a></li>
      </ul>
   </div>
</div>
{% endblock container %}


