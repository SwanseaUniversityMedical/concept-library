{
  "template_details": {
    "version": 1,
    "name": "Atlas Phecode Phenotype",
    "description": "A manually curated group of clinical codes intended to capture clinically meaningful concepts for research",
    "card_type": "clinical"
  },

  "sections": [
    {
      "title": "Name & Author",
      "description": "",
      "fields": ["name", "author"],
      "hide_on_detail": true
    },
    {
      "title": "Overview",
      "description": "An overview of the phenotype with basic metadata.",
      "fields": ["type", "coding_system", "data_sources", "collections", "tags", "source_reference"]
    },
    {
      "title": "Definition",
      "description": "",
      "fields": ["definition"]
    },
    {
      "title": "Implementation",
      "description": "How this phenotype definition is run against data.",
      "fields": ["implementation"],
      "hide_if_empty": true
    },
    {
      "title": "Validation",
      "description": "Description of how correctness, appropriateness, and/or quality was assessed.",
      "fields": ["validation"],
      "do_not_show_in_production": true,
      "hide_if_empty": true
    },
    {
      "title": "Phecode",
      "description": "The associated clinical code",
      "fields": ["phecode"]
    },
    {
      "title": "Publication",
      "description": "Publication(s) where this phenotype is defined and/or used.",
      "fields": ["publications", "citation_requirements"]
    }
  ],

  "fields": {
    "type": {
      "title": "Phenotype Type",
      "description": "The category of patient characteristic this phenotype falls under.",
      "field_type": "enum_dropdown_badge",
      "active": true,
      "validation": {
        "type": "enum",
        "mandatory": true,
        "options": {
          "1": "Biomarker",
          "2": "Disease or syndrome",
          "3": "Drug",
          "4": "Lifestyle risk factor",
          "5": "Musculoskeletal",
          "6": "Surgical procedure",
          "7": "Other"
        }
      },
      "search": {
        "filterable": true,
        "api": true
      }
    },
    "data_sources": {
      "title": "Data Sources",
      "description": "Data sources the phenotype creators have run this phenotype against; or view as appropriate to use this phenotype for.",
      "field_type": "data_sources",
      "active": true,
      "validation": {
        "type": "int_array",
        "mandatory": false,
        "source": {
          "table": "DataSource",
          "query": "id",
          "relative": "name",
          "include": ["uid", "url"]
        }
      },
      "search": {
        "filterable": true,
        "api": true
      }
    },
    "coding_system": {
      "title": "Coding System",
      "description":"Clinical coding system(s) contained within this phenotype. A phenotype may have multiple concepts, each with its own coding system. All contained coding systems are programmatically represented here.",
      "field_type": "coding_system",
      "active": true,
      "validation": {
        "type": "int_array",
        "mandatory": false,
        "computed": true,
        "source": {
          "table": "CodingSystem",
          "query": "codingsystem_id",
          "relative": "name"
        }
      },
      "search": {
        "filterable": true,
        "api": true
      },
      "hide_on_create": true
    },
    "phecode": {
      "title": "Phecode",
      "description": "The clinical code that captures this clinical concept",
      "field_type": "phecode",
      "active": true,
      "validation": {
        "type": "phecode",
        "mandatory": false,
        "has_children": true
      }
    },
    "source_reference": {
      "title": "Atlas Source Reference",
      "description": "The Atlas Phenotype associated with this entity (if any)",
      "field_type": "string_inputbox",
      "active": true,
      "validation": {
        "type": "string",
        "mandatory": false,
        "length": [0, 250],
        "regex": "^https?:\\/\\/(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b(?:[-a-zA-Z0-9()@:%_\\+.~#?&\\/=]*)$"
      },
      "hide_if_empty": true
    }
  }
}
