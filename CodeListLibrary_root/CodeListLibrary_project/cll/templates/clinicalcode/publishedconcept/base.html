<!DOCTYPE html>
<html lang="en">
{% load static %}
{% load mathfilters %}

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{% block description %}{% endblock description %}">
    <link rel="shortcut icon" href="{% static 'img/favicon.ico' %}">

    <title>Concept Library {% block title %}{% endblock title %}</title>

    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet" />
    <link href="{% static 'css/bootstrap-theme.min.css' %}" rel="stylesheet" />
    <link href="{% static 'css/autocomplete.css' %}" rel="stylesheet" />
    <link href="{% static 'lib/font-awesome-4.7.0/css/font-awesome.min.css' %}" rel="stylesheet" />
    <link href="{% static 'css/clusterize.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'css/jstree/style.min.css' %}" rel="stylesheet" />
    <link href="{% static 'lib/bootstrap-datepicker/css/bootstrap-datepicker.min.css' %}" rel="stylesheet" />
    <link href="{% static 'css/bootstrap-tagsinput.css' %}" rel="stylesheet" />
    <link href="{% static 'css/bootstrap-tagsinput-typeahead.css' %}" rel="stylesheet" />

	<link rel="stylesheet" type="text/css" href="{% static 'css/print.css' %}" media="screen, print" />

    {% block styles %}
    <link href="{% static 'css/main.css' %}" rel="stylesheet" />
    {% if request.CURRENT_BRAND|length %}
    <link href="{% static 'css/brands/' %}{{request.CURRENT_BRAND}}/brand.css" rel="stylesheet" />
    {% endif %}
    {% endblock styles %}

	{% block head %}{% endblock head %}

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="{% static 'js/lib/html5shiv.min.js' %}" type="text/javascript"></script>
      <script src="{% static 'js/lib/respond.min.js' %}" type="text/javascript"></script>
    <![endif]-->
	</head>
	
<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <span style="color:yellow;position:absolute;left: 0;top: 0;">{{ DEV_PRODUCTION|safe }}</span>
        <div class="container">
            <div id="navbar" class="navbar-collapse collapse">
                <div class="navbar-header">

                    {% if request.CURRENT_BRAND|length %}
							<a id="logo-link"  class="navbar-brand" 
							    {% if request.CURRENT_BRAND_WEBSITE|length %}
							 	  href="{{ request.CURRENT_BRAND_WEBSITE }}"
							    {% endif %}
                              target=_blank >
								<img style="margin-top: -10px;" src="{% static 'img/brands/' %}{{request.CURRENT_BRAND}}/header_logo.png" height="45px"  alt="{{request.CURRENT_BRAND}} Logo" />
							</a>
                    {% endif %}

                    <a id="logo-link-cl" href="/{% if request.CURRENT_BRAND|length %}
                                        {{ request.CURRENT_BRAND }}/
                                        {% endif %}" class="navbar-brand">
                        <img style="margin-top: -10px;" src="{% static 'img/cl_logo_dark_1600px.png' %}" height="45px"
                            alt="Concept Library Logo" />
                    </a>
                </div>
                
                	<ul class="list-inline nav navbar-nav" id='prjnavtabs' >
						<li id="concept_li" >
							<a id="concept_a"  class="main_menu" href="{% url 'published_concept_list' %}">Published Concepts</a>
						</li>					
					</ul>
					
                <div class="navbar-header" style="float: right !important;">
					   	 
                    {% if request.user.is_superuser and user.is_authenticated and request.session.all_brands %}
                   <div class="nav navbar-nav">
                    <span style="color: white;">&nbsp;&nbsp;&nbsp;Brand</span>
                      <p class="active" style="position:relative;display: block;padding: 2px 5px">
                         <select  name="userBrand" id="userBrand"  >  
                            <option value=""  style='background-color: lightgreen;' >Default</option>
                        {% for brand in request.session.all_brands %}
                            <option value="{{ brand|upper }}" 
                                   {% if brand|upper == request.session.current_brand|upper %} selected="selected" {% endif %}
                                   >
                                    {{ brand|upper }}
                                    {% if brand|upper in request.session.user_brands %} (*) {% endif %}
                            </option>
                        {% empty %}
                            <option value="-1" >No Brands !!!</option>
                        {% endfor %}
                          </select>
                      </p>
                    </div>
                {% endif %}
                
                </div>
            </div>
        </div>
    </nav>
    {% block container %}{% endblock container %}

<!-- SITE FOOTER -->
{% block footer %}
<footer>
	<div class="container">
	    <span style="color:yellow;">{{ DEV_PRODUCTION|safe }}</span>
		<p>Copyright &copy; {% now 'Y' %} - SAIL Databank - Swansea University. All rights reserved.</p>	
		
		<div class="navbar-header">
			<a href="http://saildatabank.com" target=_blank  class="navbar-brand" rel="noopener noreferrer">
				<img style="margin-top: -10px;" src="{% static 'img/SAIL2-d.png' %}" height="45px"  alt="SAIL Databank Logo" />
			</a>
			<a href="http://www.swansea.ac.uk" target=_blank  class="navbar-brand" rel="noopener noreferrer">
				<img style="margin-top: -10px;" src="{% static 'img/logo.png' %}" height="45px" alt="Swansea University Logo" />
			</a>	
		</div>					    
	</div>
</footer>	 
{% endblock footer %}

<script src="{% static 'js/lib/jquery/jquery-3.1.1.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/lib/bootstrap/bootstrap.min.js' %}" type="text/javascript"></script>
    
<script type="text/javascript">
//Setting an active menu item based on the current URL with jQuery

	$(function () {
	    setNavigation();
	});

	function setNavigation() {
	    var path = window.location.pathname;
	    path = path.replace(/\/$/, "");
	    path = decodeURIComponent(path);
	    //alert(path);

	    $("#prjnavtabs a").each(function () {
	        var href = $(this).attr('href');
	        href = href.replace(/\/$/, "");
	        //alert(href);
	        if (path.substring(0, href.length) === href) {
	        	//alert();
	            $(this).closest('li').addClass('active');
	        }
	    });
	}

</script>

<script>
    $(function(){
        var lTrimRegex = new RegExp('^/');
        var lTrim = function(input){
            return input.replace(lTrimRegex, '');
        }
        
        var all_brands = []; // {{ request.session.all_brands|safe }};
        {% for brand in request.session.all_brands %}
            all_brands.push('{{ brand|upper }}');
        {% endfor %}

        $( '#userBrand' ).on('change', function(e){
            $(".loader").show();
            var path = window.location.pathname;
            path = lTrim(path);
            old_root = path.split('/')[0];
            
            new_root = '';
            if(this.value != ''){
                new_root = '/' + this.value;
            }
            
            indx = 1;
            if(all_brands.indexOf(old_root.toUpperCase()) == -1){
                indx = 0;
            }
            window.location.href = document.location.origin + new_root + '/' + path.split('/').slice(indx).join('/');
            
            $(".loader").hide();

            });
    });
    
</script>

{% block scripts %}
{% endblock scripts %}

</body>
</html>